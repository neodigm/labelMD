angular.module("angular-simple-sidebar", []).directive("angularSimpleSidebar", function(hotkeys) {
    var tabOpen = false;
    var escObj;
    return {
        restrict:"E", transclude:!0, scope: {
            items: "=", state: "=", title: "=", settings: "=", expanded: "=", collapsed: "="
        }
        , template:'<a href class="ass-menu-button" aria-label="{{ariaLabel}}" title="{{::title}}" ng-click="openSidebar()"><i class="eg-font-2 eg-bars-icon"></i></a><div><aside class="ass-aside-menu ass-slide-{{slide}}"><small ng-if="settings.close" class="ass-aside-menu-close" ng-click="closeSidebar()"><span ng-if="!settings.closeIcon">[x]</span><span ng-if="settings.closeIcon"><i class="{{::settings.closeIcon}}"></i></span></small><h3 class="ass-aside-menu-title"></h3><a id="{{item.id}}" href="{{::item.link}}" target="{{::item.target}}" class="ass-aside-menu-item"  ng-click="closeSidebar()" ng-repeat="item in items" tabindex="-1" aria-labelledby="{{::item.name|translate}}"><i ng-if="::item.icon" class="{{::item.icon}} ass-aside-menu-icon"></i><span>{{::item.name|translate}}</span></a></aside><div ng-if="state" class="ass-aside-overlay" ng-click="closeSidebar()"></div></div>', link:function(a, b, c) {
            a.ariaLabel = a.title + ' ' + a.collapsed;
            a.slide, a.state&&(a.slide="in"), a.openSidebar=function() {
                if(!tabOpen) {
                    escObj = hotkeys.get('esc');
                    hotkeys.add({
                        combo: 'esc',
                        description: 'Close sidebar',
                        callback: function () {
                            if(tabOpen) {
                                a.closeSidebar();
                            }
                        }
                    });
                    tabOpen = true;
                    a.ariaLabel = a.title + ' ' + a.expanded;
                    a.state=!0, a.slide="in";
                    if(a.items) {
                        for(var i=0; i< a.items.length; i++) {
                            document.getElementById(a.items[i].id).tabIndex = 0;
                        }
                    }
                }
                else {
                    a.closeSidebar();
                }
            }
            , a.closeSidebar=function() {
                tabOpen = false;
                a.ariaLabel = a.title + ' ' + a.collapsed;
                hotkeys.del('esc');
                hotkeys.add(escObj);
                a.state=!1, a.slide="out";
                if(a.items) {
                    for(var i=0; i< a.items.length; i++) {
                        document.getElementById(a.items[i].id).tabIndex = -1;
                    }
                }
            };
        }
    };
}

);