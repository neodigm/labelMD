var EGAINCLOUD;EGAINCLOUD||function(i,h){function G(a){return a?(a^16*Math.random()>>a/4).toString(16):([1E7]+-1E3+-4E3+-8E3+-1E11).replace(/[018]/g,G)}function v(){if(!0!==z&&(z=!0,clearTimeout(H),0<w.length))for(var a=0;a<w.length;a++)b.App.inject(w[a])}function k(a){return a.replace(/^\s+|\s+$/g,"")}function l(a){return!(!a||/^\s*$/.test(a))}function O(){-1!==A&&(H=i.setTimeout(function(){v()},1E3*A))}var b={},z,q="",g="",j="",B=null,r,s,x,w=[],H,C=!1,t=!1,o=null,D=!1,m=!1,E=!1,F=!1,I=!1,A=1,J,K,L,p=!1,M=!1,u=!0,y=!0,N=!1;_onetagdomain="https://analytics.analytics-egain.com";_iframeURL=_onetagdomain+"/iframe";_storageURL="https://cloud-us.analytics-egain.com/tracker";_offersPageURL="";_FN_MAP={setCustomAttr:"addToCustomBuffer",setUserID:"setUID",enableTracker:"setTrackerFlag",trackPageView:"handleTrackerEvent",disableTrackOnLoad:"delayTrackerEvent",loadOffers:"handleOffersLoadEvent",disableOffersOnLoad:"delayOffersLoadEvent",unloadOffers:"handleOffersUnloadEvent",send:"addeGainEvent",clearData:"clearStorage"};b.init=function(a){if(a&&(a.domain&&(B=a.domain),a.aId&&(q=a.aId),g=b.Cookie.get("EG-S-ID"),j=b.Cookie.get("EG-U-ID"),C=l(a.delayLoad)&&(!0===a.delayLoad||"true"===a.delayLoad),a.delayLoadTime&&(A=a.delayLoadTime),b.Account.isValid()&&a.apps&&0<a.apps.length)){b.Tracker.processArrayQ();for(var d=0;d<a.apps.length;d++){var c=a.apps[d];l(c.name)&&/analytics/i.test(c.name)?b.Cookie.isCookieSupported()?(D=!0,m=l(c.partial)&&(!0===c.partial||"true"===c.partial),E=l(c.collectQueryParams)&&(!0===c.collectQueryParams||"true"===c.collectQueryParams),N=l(c.disableFallBack)&&(!0===c.disableFallBack||"true"===c.disableFallBack)):u=!1:l(c.name)&&/Capture eGain Application Events/i.test(c.name)?b.Cookie.isCookieSupported()&&(F=!0,I=l(c.recordUserMessages)&&(!0===c.recordUserMessages||"true"===c.recordUserMessages)):C?w[d-1]=c:b.App.inject(c)}(F||!p)&&b.Tracker.sendNavCheck();C&&(a=h.isEGFIF?i.parent.document:h,a="loaded"===a.readyState||"complete"===a.readyState?!0:!1,a?v():(a=h.isEGFIF?i.parent:i,a.addEventListener?a.addEventListener("load",v,!1):a.attachEvent("onload",v),O()))}};b.isWinLoaded=function(){return!0===z};b.Cookie={set:function(a,b,c,e,f,n){h.cookie=a+"="+escape(b)+(null==e?"":"; expires="+e.toGMTString())+(null==c?"":"; path="+c)+(null==f?"":"; domain="+f)+(!0==n?"; secure":"")},get:function(a){for(var a=a+"=",b=h.cookie.split(";"),c=0;c<b.length;c++){for(var e=b[c];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(a))return unescape(e.substring(a.length,e.length))}return null},isCookieSupported:function(){if(!1===navigator.cookieEnabled)return!1;if(!h.cookie){h.cookie="testcookie=1";if(!h.cookie)return!1;h.cookie="testcookie=; expires="+(new Date(0)).toUTCString()}return!0},remove:function(a,b){if(a){var c=a.split(",");b||(b="/");for(var e=0;e<c.length;e++)h.cookie=c[e]+"=;expires="+(new Date(0)).toUTCString()+";path="+b+";"}}};b.Storage={isStorageSupported:function(){try{return sessionStorage.setItem("egtest","egtest"),sessionStorage.removeItem("egtest"),!0}catch(a){return!1}},set:function(a,b,c){try{("user"==c?localStorage:sessionStorage).setItem(a,b)}catch(e){}},get:function(a,b){var a=a.split(","),c=[];try{for(var e,f,n="user"==b?localStorage:sessionStorage,h=0;h<a.length;h++)e=a[h],f=n.getItem(e),c.push(f)}catch(g){}return 1<c.length?c:c[0]},remove:function(a,b){a=a.split(",");try{for(var c,e="user"==b?localStorage:sessionStorage,f=0;f<a.length;f++)c=a[f],e.removeItem(c)}catch(h){}},clear:function(){b.Storage.remove("EG-LnTime","user");b.Storage.remove("EG-BUFFER-FLAG");b.Exchange.send("CLEAR-STORAGE")}};b.Cache={set:function(a,d,c,e){if(!e&&b.Storage.isStorageSupported())b.Storage.set(a,d,c);else switch(c){case "session":b.Cookie.set(a,d,"/");break;case "user":c=new Date,c.setDate(c.getDate()+365),b.Cookie.set(a,d,"/",c)}},get:function(a){return b.Cookie.get(a)},clear:function(){b.Cookie.remove("EG-U-ID,EG-S-ID,EG-SEQ-ID");b.Storage.clear()}};b.guid=function(){return"eg"+(1073741824*Math.random()).toString(16).replace(".","")};b.uuid=function(){return G()};b.randomPrefix=function(){return["A","B","C","D","E"][Math.floor(5*Math.random())]+Math.floor(10*Math.random())};b.Account={isValid:function(){if(B)for(var a=B.split(","),b=0,c=a.length;b<c;b++)if(RegExp(k(a[b]).replace("*",""),"i").test(h.URL))return!0;return!1},getId:function(a){switch(a){case "account":return q;case "session":return g;case "user":return j}},getAllIds:function(){return{a:q,s:g,u:j}}};b._callback={};b.App={inject:function(a){var d=h.isEGFIF?i.parent.document:h,c=d.getElementsByTagName("script")[0],e=d.createElement("script");if(l(a.code))try{e.appendChild(d.createTextNode(a.code))}catch(f){e.text=a.code}else if(l(a.codePath))e.src=a.codePath;else if(l(a.webServer)){var d=k(a.webServer),n=l(a.contextRoot)?k(a.contextRoot):"system",g=l(a.protocol)&&!/both/i.test(a.protocol)?k(a.protocol)+":":"";if(l(a.name)){if(/offers/i.test(a.name)){b.Cookie.isCookieSupported()||b.Storage.isStorageSupported()?(J=g+"//"+d+"/"+n,M||b.Offers.inject()):y=!1;return}/cobrowse/i.test(a.name)?(e.id="_egainallowcobrowse",e.src=g+"//"+d+"/"+n+"/cb/admin/js/allow_cobrowse.js"):/Chat \/ VA \(Docked\)/i.test(a.name)?(e.id="_egainallowdockchat",e.src=g+"//"+d+"/"+n+"/templates/chat/egain-chat.js"):/socialsales/i.test(a.name)?(e.id="_egainallowcobrowse",e.src=g+"//"+d+"/"+n+"/cb/admin/js/allow_cobrowse.js"):/assistedsales/i.test(a.name)&&(e.id="_egainallowcobrowse",e.src=g+"//"+d+"/"+n+"/cb/admin/js/allow_cobrowse.js",a.name="offers",b.App.inject(a))}}c.parentNode.insertBefore(e,c)}};b.Offers={inject:function(a){var d=h.isEGFIF?i.parent.document:h,c=d.getElementsByTagName("script")[0],e=d.createElement("script"),f=a&&a.title||d.title,a=a&&a.page||d.URL;b.Offers.setPageURL(a);b.Offers.matchURL(a)&&(e.id="eGainOffers",e.src=J+"/Offers.egain?command=GetRulesJS&egofferpageurl="+encodeURIComponent(a)+"&egofferpagetitle="+encodeURIComponent(f)+"&egofferpatternchecksum="+encodeURIComponent(b.Offers.getPatternCheckSum()),c.parentNode.insertBefore(e,c))},getStorageType:function(){return"local"==b.Storage.get("eGOFRStorage","user")?"user":"session"},getPatternCheckSum:function(){return b.Storage.get("eGOFRPatternsChecksum",b.Offers.getStorageType())||""},matchURL:function(a){if(b.Storage.isStorageSupported()){var d=h.isEGFIF?i.parent:i;d.eGOFRPatternStore||(d.eGOFRPatternStore=function(a,c,d,e){b.Storage.set("eGOFRStorage",a,"user");b.Storage.set("eGOFRPatterns",c,b.Offers.getStorageType());b.Storage.set("eGOFRPatternsExpSec",d,b.Offers.getStorageType());b.Storage.set("eGOFRPatternsChecksum",e,b.Offers.getStorageType());b.Storage.set("eGOFRPatternsSetTime",(new Date).getTime()+"",b.Offers.getStorageType())});if(!b.Offers.getPatternCheckSum())return!0;var d=(new Date).getTime(),c=b.Storage.get("eGOFRPatternsExpSec",b.Offers.getStorageType()),e=b.Storage.get("eGOFRPatternsSetTime",b.Offers.getStorageType()),c=isNaN(c)?"0":c,e=isNaN(e)?"0":e,c=1E3*parseInt(c,10),e=parseInt(e,10);if(0>d-e||d-e>c)return b.Storage.remove("eGOFRPatternsChecksum",b.Offers.getStorageType()),!0;if(d=b.Storage.get("eGOFRPatterns",b.Offers.getStorageType())){d=d.split("$EGOFR$");for(e=0;e<d.length;++e)if(RegExp(d[e]).test(a))return!0}return!1}return!0},setPageURL:function(a){_offersPageURL=a},getPageURL:function(){return _offersPageURL}};b.Server={jsonp:function(a,d){var c=b.guid(),e=h.getElementsByTagName("script")[0],f=h.createElement("script"),a=a+((-1<a.indexOf("?")?"&":"?")+"_cb_=EGAINCLOUD._callback."+c);if(2E3<a.length)throw Error("JSONP only support a maximum of 2000 bytes of input.");b._callback[c]=function(a){d&&d(a);delete b._callback[c];f.parentNode.removeChild(f)};f.onerror=function(){if(c in b._callback)b._callback[c]({error:"load-error: unknown"})};var g=function(){setTimeout(function(){if(c in b._callback)f.onerror()},0)};f.addEventListener?f.addEventListener("load",g,!1):f.onreadystatechange=function(){/loaded|complete/.test(this.readyState)&&g()};f.src=a;e.parentNode.insertBefore(f,e)}};b.Tracker={_customBuffer:[],getBaseURL:function(){return _storageURL+(-1<_storageURL.indexOf("?")?"&":"?")+(q?"aId="+q:"")+(g?"&sId="+g:"")+(j?"&uId="+j:"")},getSequenceParam:function(a){return a?"&seqId="+b.Tracker.getNextSequenceNumber():"&seqId="+(b.Tracker.getCurrentSequenceNumber()+1)},getIframeURL:function(){return _iframeURL+"/"+q},handleTrackerEvent:function(a){!1!==u&&b.Tracker.sendNavCheck("tracker",a)},delayTrackerEvent:function(){!1!==u&&(p=!0)},handleOffersLoadEvent:function(a){if(!1!==y){b.Tracker.handleOffersUnloadEvent();var d=h.getElementById("eGainOffers");d&&d.parentNode.removeChild(d);b.Offers.inject(a)}},delayOffersLoadEvent:function(){!1!==y&&(M=!0)},handleOffersUnloadEvent:function(){if(!1!==y){var a=h.isEGFIF?i.parent:i;a.eGOFR&&a.eGOFR.unloadOffers&&a.eGOFR.unloadOffers()}},handleChatEvent:function(a){!1!==u&&b.Tracker.sendNavCheck("chat",a)},addeGainEvent:function(a,d,c,e,f){if(F&&("wb"===a||"em"===a||"cht"===a||"soc"===a||"wss"===a||"vce"===a||"app"===a||"str"===a||"c2c"===a||"cb"===a)&&("nav"===d||"uac"===d||"aac"===d||"aev"===d||"ctx"===d)&&101===e&&f&&typeof f.EventName){if(!0!==I)switch(f.EventName){case "ChatRequested":delete f.Name;delete f.Email;delete f.PhoneNumber;delete f.Question;break;case "ChatCustomerMsg":case "ChatAgentMsg":delete f.Message;break;case "ChatSurveySubmitted":delete f.Comment;break;case "KBEmailSubmit":delete f.CustomerEmailAddress}E||(c=b.Tracker.removeQueryParams(c));var a="&ct="+encodeURIComponent(a)+"&et="+encodeURIComponent(d)+"&ic="+encodeURIComponent(c)+"&cv="+encodeURIComponent(e),g;for(g in f)f.hasOwnProperty(g)&&(a=a+"&"+encodeURIComponent(g)+"="+encodeURIComponent(f[g]));b.Tracker._customBuffer.push({eventData:a})}},processBufferOpts:function(a,d){if(m){var c=b.Storage.get("EG-BUFFER-FLAG");!c||"ON"===c?(a&&(K=a,L=d),b.Exchange.send("isFlagOff")):"OFF"===c&&(m=!1,b.Tracker.sendNav(a,d))}else!j||!g?b.Exchange.send("GET-UID-SID"):g&&(b.Tracker.addToStorageBuffer(),p?b.Tracker.sendCustom():b.Tracker.sendNav(a,d))},sendNavCheck:function(a,d){D&&(i.postMessage&&b.Storage.isStorageSupported()?!1===t?b.Iframe.add(a,d):!0===t&&b.Tracker.processBufferOpts(a,d):m?!1===N&&(m=!1,b.Tracker.sendNav(a,d)):p?b.Tracker.sendCustom():b.Tracker.sendNav(a,d))},sendNav:function(a,d){var c=h.isEGFIF?i.parent.document:h,e=b.Tracker.getBaseURL(),f=b.Tracker.getSequenceParam(),n=b.Tracker.getCurrentTimeQS(),k="&nTime="+n;d?(x=d.title||c.title,s=d.page||c.URL,r=d.referrer||c.referrer):(x=c.title,s=c.URL,r=c.referrer);E||(s=b.Tracker.removeQueryParams(s),r=b.Tracker.removeQueryParams(r));c="&pU="+encodeURIComponent(s)+"&pT="+encodeURIComponent(x)+"&pR="+encodeURIComponent(r);"chat"===a&&(c="&ceFlag=1"+c);if(m){var c=k+c,l=b.Storage.get("EG-LnTime","user");l&&l>n&&(c="&flag=nTimeError"+c);b.Storage.set("EG-LnTime",n,"user")}f=e+f+c;!m&&1940<(f+k).length&&(f=(e+"&flag=trimURL"+c).substring(0,1940),c=c.substring(0,1940-e.length-13-k.length));m?(j||(c="&isNewUser=1"+c,j=b.randomPrefix()+b.uuid(),b.Cache.set("EG-U-ID",j,"user",!0)),g||(g=b.randomPrefix()+b.uuid(),b.Cache.set("EG-S-ID",g,"session",!0)),b.Tracker.addToStorageBuffer(c)):(!0===t&&b.Exchange.send("GET"),b.Tracker.getSequenceParam(!0),b.Server.jsonp(f,function(a){if(a.uId){j=a.uId;b.Cache.set("EG-U-ID",j,"user",true)}if(a.sId){g=a.sId;b.Cache.set("EG-S-ID",g,"session",true);b.Tracker.addToStorageBuffer()}b.Tracker.sendCustom()}))},removeQueryParams:function(a){var b=a;index=a.indexOf("?");-1==index&&(index=a.indexOf("#"));-1!=index&&(b=a.substring(0,index));return b},setUID:function(a){j=a},setTrackerFlag:function(a){if(!1!==u&&(!0===a||"true"==a))m?(b.Storage.set("EG-BUFFER-FLAG","OFF"),b.Exchange.send("GET")):b.Tracker.handleChatEvent({title:x,page:s,referrer:r})},processQ:function(a){for(var d=0;d<a.length;d++){var c=a[d].slice(1,a[d].length),e=_FN_MAP[a[d][0]];"undefined"!==typeof e&&b.Tracker[e].apply(null,c)}},processArrayQ:function(){var a=h.isEGFIF?i.parent:i,d=a.EG_CALL_Q||[],d=d.slice(0,d.length);a.EG_CALL_Q=b.CallQueue;b.Tracker.processQ(d)},addToCustomBuffer:function(a,d,c){a=a.toLowerCase();b.Tracker._customBuffer.push({name:"_"+("user"==a?"u":"session"==a?"s":"p")+"_"+encodeURIComponent(d),value:encodeURIComponent(c)})},addToStorageBuffer:function(a){b.Exchange.send("SET",a)},getCustomQS:function(a){for(var d=b.Tracker._customBuffer,c="",a=a||d.length,e=0;0<d.length&&e<a;e++)c=d[e].hasOwnProperty("eventData")?c+d[e].eventData:c+("&"+d[e].name+"="+d[e].value);return c},getCurrentTimeQS:function(){return(new Date).getTime()},sendCustom:function(){if(D&&(g||p&&!(p&&0<b.Tracker.getCurrentSequenceNumber()))){var a=b.Tracker.getBaseURL(),d=b.Tracker.getCustomQS(1),c="&nTime="+b.Tracker.getCurrentTimeQS();if(0<d.length)if(!g||1==b.Tracker._customBuffer.length){b.Tracker._customBuffer.shift();for(var e=1940>=(a+b.Tracker.getSequenceParam()+d).length||m&&1940>=(a+b.Tracker.getSequenceParam()+c+d).length;!g&&!e&&b.Tracker._customBuffer.length;)d=b.Tracker.getCustomQS(1),b.Tracker._customBuffer.shift(),e=1940>=(a+b.Tracker.getSequenceParam()+d).length||m&&1940>=(a+b.Tracker.getSequenceParam()+c+d).length;e&&b.Tracker.sendCustomData(a,c,d,!0)}else for(;b.Tracker._customBuffer.length;)d=b.Tracker.getCustomQS(1),c="&nTime="+b.Tracker.getCurrentTimeQS(),b.Tracker._customBuffer.shift(),0<d.length&&(1940>=(a+b.Tracker.getSequenceParam()+d).length||m&&1940>=(a+b.Tracker.getSequenceParam()+c+d).length)&&b.Tracker.sendCustomData(a,c,d,!1)}},sendCustomData:function(a,d,c,e){m?b.Tracker.addToStorageBuffer(d+c):b.Server.jsonp(a+b.Tracker.getSequenceParam(!0)+c,function(a){a.uId&&(j=a.uId,b.Cache.set("EG-U-ID",j,"user",!0));a.sId&&(g=a.sId,b.Cache.set("EG-S-ID",g,"session",!0),b.Tracker.addToStorageBuffer(),e&&b.Tracker.sendCustom())})},sendAllFromStorageBuffer:function(a){if(a)for(var a=a.split("|$$|"),d=b.Tracker.getBaseURL(),c=b.Tracker.getCurrentTimeQS();a.length;){var e=a.shift();if(0<e.length){var f="",g="&cTime="+c;b.Tracker.sendFromStorageBuffer(d+b.Tracker.getSequenceParam(!0),f,g,e);0===a.length&&(-1<e.indexOf("&start=1")&&(e=e.replace("&start=1","").replace("&isNewUser=1","")),f="&ceFlag=1",b.Tracker.sendFromStorageBuffer(d+b.Tracker.getSequenceParam(!0),f,g,e))}}},sendFromStorageBuffer:function(a,d,c,e){var f=a+d+c+e;1940<=f.length&&(f=(a+d+c+"&flag=trimURL"+e).substring(0,1940));b.Server.jsonp(f,function(){})},getCurrentSequenceNumber:function(){var a=b.Cache.get("EG-SEQ-ID");a||(a=0);return parseInt(a)},getNextSequenceNumber:function(){var a=b.Tracker.getCurrentSequenceNumber()+1;b.Cache.set("EG-SEQ-ID",a,"session",!0);return a},clearStorage:function(a){(!0===a||"true"==a)&&b.Cache.clear()}};b.CallQueue={push:function(){b.Tracker.processQ(arguments);b.Tracker.sendCustom()}};b.Exchange={ifrStrToObj:function(a){var b=a.slice(1,a.length-1).split(",",4),a=b[0].slice(10,b[0].length-1),c=b[1].slice(7,b[1].length-1),e=b[2].slice(7,b[2].length-1),b=b[3].slice(11,b[3].length-1);return{action:a,uId:c,sId:e,message:b}},send:function(a,d,c){!1!==t&&("session"!==c&&(c="user"),a='{"action":"'+a+'","scope":"'+c+'","aId":"'+b.Account.getId("account")+'","uId":"'+b.Cache.get("EG-U-ID")+'","sId":"'+b.Cache.get("EG-S-ID")+'","message":"'+d+'"}',o.contentWindow.postMessage(a,b.Tracker.getIframeURL()))},receive:function(a){k(a.origin)===_onetagdomain&&(a.data.substring&&"action"===a.data.substring(2,8))&&(a=b.Exchange.ifrStrToObj(a.data),"bufferData"===a.action&&b.Tracker.sendAllFromStorageBuffer(a.message),"FlagStatus"===a.action&&("OFF"===a.message?(b.Storage.set("EG-BUFFER-FLAG","OFF"),m=!1):b.Storage.set("EG-BUFFER-FLAG","ON"),0<k(a.uId).length&&!j&&(j=k(a.uId),b.Cache.set("EG-U-ID",j,"user",!0)),0<k(a.sId).length&&!g&&(g=k(a.sId),b.Cache.set("EG-S-ID",g,"session",!0)),b.Tracker.sendNav(K,L)),"uIdsId"===a.action&&(0<k(a.uId).length&&(j=k(a.uId),b.Cache.set("EG-U-ID",j,"user",!0)),0<k(a.sId).length&&(g=k(a.sId),b.Cache.set("EG-S-ID",g,"session",!0)),p?b.Tracker.sendCustom():b.Tracker.sendNav()))}};b.Iframe={add:function(a,d){o=h.createElement("IFRAME");o.setAttribute("src",b.Tracker.getIframeURL());o.style.display="none";-1<navigator.userAgent.indexOf("MSIE")&&!i.opera?o.onreadystatechange=function(){if("loaded"===o.readyState||"complete"==o.readyState)t=!0,b.Tracker.processBufferOpts(a,d)}:o.onload=function(){t=!0;b.Tracker.processBufferOpts(a,d)};i.addEventListener?i.addEventListener("message",b.Exchange.receive,!1):i.attachEvent("onmessage",b.Exchange.receive);h.getElementsByTagName("head")[0].appendChild(o)}};EGAINCLOUD=b;h.isEGFIF&&(i.parent.EGAINCLOUD=EGAINCLOUD)}(window,document);EGAINCLOUD.init({"aId":"EG73612092","domain":"ltdcommodities.egain.cloud,egeng.info,egdemo.info,stage2.ltdcommodities.com,stage2.lakeside.com,stage.ltdcommodities.com,stage.lakeside.com,ltdcommodities.com,lakeside.com","delayLoad":"false","apps":[{"name":"Analytics","collectQueryParams":"true","partial":"true"},{"protocol":"both","contextRoot":"system","name":"Chat \/ VA (Docked)","webServer":"ltdcommodities.egain.cloud"}]});