/*! egain-angular-services 28-03-2018 */
app.factory("ChatService",["$http","$q","$rootScope",function(a,b,c){function d(a){var b="";return angular.isDefined(a)&&angular.forEach(a,function(a,c){b+=a+","}),b.substring(0,b.length-1)}var e={},f={"CHAT-100":"Entry Point ID is blank or missing","CHAT-101":"Invalid value for entry point","CHAT-102":"Entry Point ID provided does not exist","CHAT-103":"User not authorized to access the resource","CHAT-105":"Internal server error","CHAT-107":"CORS support is not enabled","CHAT-201":"Question Text is blank or missing","CHAT-202":"Answer Text is missing","CHAT-300":"Portal ID used is invalid","CHAT-301":"User type used is invalid","CHAT-302":"Casebase ID used is invalid","CHAT-303":"User is not authorized to access the resource","CHAT-304":"Portal ID does not exist","CHAT-305":"Casebase ID does not exist","CHAT-306":"Usertype provided does not match with existing usertype","CHAT-307":"Quick picks can only be created for Live releases","CHAT-308":"Cannot process request as SP authentication is enabled"};e.IsAgentAvailable=function(a,c){var d=b.defer();return g(a,d,c),d.promise},e.GetAgentCapacity=function(a,c){var d=b.defer();return h(a,d,c),d.promise},e.GetCurrentLoadOnQueue=function(a,c){var d=b.defer();return i(a,d,c),d.promise},e.GetWaitTime=function(a,c){var d=b.defer();return j(a,d,c),d.promise},e.GetStatusForQueueDepthAndAgentAvailability=function(a,c,d,e){var f=b.defer();return k(a,c,d,f,e),f.promise},e.EntryPointIsHealthy=function(a,c){var d=b.defer();return l(a,d,c),d.promise},e.SubmitSurvey=function(a,c,d){var e=b.defer();return m(a,c,e,d),e.promise},e.GetAttributesInfo=function(a,c,d,e){var f=b.defer();return n(a,c,d,f,e),f.promise},e.SearchPriorToEscalation=function(a,c,d,e,f,g,h,i,j,k,l){var m=b.defer();return o(a,c,d,e,f,m,g,h,i,j,k,l),m.promise},e.AvertEscalation=function(a,c,d){var e=b.defer();return q(a,c,d,e),e.promise},e.GetArticle=function(a,c,d,e,f,g,h){var i=b.defer();return p(a,c,d,e,f,g,h,i),i.promise},e.InitiateSession=function(a,c){var d=b.defer();return r(a,c,d),d.promise},e.AddQuickpick=function(a,c,d,e,f,g,h,i){var j=b.defer();return s(a,c,d,e,f,g,h,i,j),j.promise};var g=function(b,d,e){var f={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}};return t(b)?(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-100",f.errorObject.severity="LOW",d.resolve(f)):u(b)?a({method:"GET",url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/agentAvailability/"+b,headers:{"X-egain-session":e}}).then(function(a){f.isErrorPresent=!1,f.returnData={},f.errorObject={},f.returnData=a.data,d.resolve(f)},function(a){switch(a.status){case-1:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-107",f.errorObject.severity="HIGH",d.resolve(f);break;case 500:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f);break;default:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f)}}):(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-101",f.errorObject.severity="LOW",d.resolve(f))},h=function(b,d,e){var f={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}};return t(b)?(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-100",f.errorObject.severity="LOW",d.resolve(f)):u(b)?a({method:"GET",url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/capacity/"+b,headers:{"X-egain-session":e}}).then(function(a){f.isErrorPresent=!1,f.returnData={},f.errorObject={};var b=eGainJsUtilities.xmlToJson((new DOMParser).parseFromString(a.data,"text/xml"));f.returnData.agentCapacity=b.availableSlots["ns2:count"]["#text"],d.resolve(f)},function(a){switch(a.status){case-1:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-107",f.errorObject.severity="HIGH",d.resolve(f);break;case 500:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f);break;default:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f)}}):(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-101",f.errorObject.severity="LOW",d.resolve(f))},i=function(b,d,e){var f={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}};return t(b)?(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-100",f.errorObject.severity="LOW",d.resolve(f)):u(b)?a({method:"GET",url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/liveSessionStatus/"+b,headers:{"X-egain-session":e}}).then(function(a){f.isErrorPresent=!1,f.returnData={},f.errorObject={},f.returnData.queueDepth=a.data.queueDepth,d.resolve(f)},function(a){switch(a.status){case-1:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-107",f.errorObject.severity="HIGH",d.resolve(f);break;case 500:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f);break;default:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f)}}):(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-101",f.errorObject.severity="LOW",d.resolve(f))},j=function(b,d,e){var f={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}};return t(b)?(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-100",f.errorObject.severity="LOW",d.resolve(f)):u(b)?a({method:"GET",url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/liveSessionStatus/"+b,headers:{"X-egain-session":e}}).then(function(a){f.isErrorPresent=!1,f.returnData={},f.errorObject={},f.returnData.waitTime=a.data.waitTime,d.resolve(f)},function(a){switch(a.status){case-1:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-107",f.errorObject.severity="HIGH",d.resolve(f);break;case 500:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f);break;default:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f)}}):(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-101",f.errorObject.severity="LOW",d.resolve(f))},k=function(b,d,e,f,g){var h={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}};if(t(b))return h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-100",h.errorObject.severity="LOW",f.resolve(h);if(!u(b))return h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-101",h.errorObject.severity="LOW",f.resolve(h);var i="";return d&&(i="?videoChat=1",null!==e&&"number"==typeof e&&(i+="&avmode="+e)),a({method:"GET",url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/checkEligibility/"+b+i,headers:{"X-egain-session":g}}).then(function(a){h.isErrorPresent=!1,h.returnData={},h.errorObject={};var b=eGainJsUtilities.xmlToJson((new DOMParser).parseFromString(a.data,"text/xml")),c=b.checkEligibility["@attributes"].responseType;"0"===c?h.returnData.status="IS-OK":"1"===c?h.returnData.status="AGENT-NOT-AVAILABLE":"2"===c&&(h.returnData.status="MAX-QUEUE-DEPTH-EXCEEDED"),f.resolve(h)},function(a){switch(a.status){case-1:h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-107",h.errorObject.severity="HIGH",f.resolve(h);break;case 500:h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-105",h.errorObject.severity="HIGH",f.resolve(h);break;default:h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-105",h.errorObject.severity="HIGH",f.resolve(h)}})},l=function(b,d,e){var f={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}};return t(b)?(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-100",f.errorObject.severity="LOW",d.resolve(f)):u(b)?a({method:"GET",headers:{"Content-Type":"application/json","X-egain-session":e},url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/chatAllowed/"+b}).then(function(a){f.isErrorPresent=!1,f.returnData={},f.errorObject={};var b=eGainJsUtilities.xmlToJson((new DOMParser).parseFromString(a.data,"text/xml"));b.chatAllowed["@attributes"].allowed?f.returnData.isHealthy=!0:(f.returnData.isHealthy=!1,f.returnData.reason=b.chatAllowed["@attributes"].reason),d.resolve(f)},function(a){switch(a.status){case-1:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-107",f.errorObject.severity="HIGH",d.resolve(f);break;case 500:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f);break;default:f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-105",f.errorObject.severity="HIGH",d.resolve(f)}}):(f.isErrorPresent=!0,f.errorObject.errorCode="CHAT-101",f.errorObject.severity="LOW",d.resolve(f))},m=function(b,d,e,f){var g={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}},h='<egainSurvey sid="'+b+'" xmlns="http://bindings.egain.com/chat">';return angular.forEach(d,function(a){if(!angular.isDefined(a.Question))return g.isErrorPresent=!0,g.errorObject.errorCode="CHAT-201",g.errorObject.severity="LOW",e.resolve(g);if(!angular.isDefined(a.Answer))return g.isErrorPresent=!0,g.errorObject.errorCode="CHAT-202",g.errorObject.severity="LOW",e.resolve(g);var b=w(a.Question);h=h+"<survey><question>"+b+"</question><answer>"+("string"==typeof a.Answer?"<![CDATA["+w(a.Answer)+"]]>":a.Answer)+"</answer></survey>"}),h+="</egainSurvey>",a({method:"POST",url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/survey",headers:{"Content-Type":"text/XML","X-egain-session":f},data:h}).then(function(a){g.isErrorPresent=!1,g.returnData={},g.errorObject={},g.returnData=a.data,e.resolve(g)},function(a){switch(a.status){case-1:g.isErrorPresent=!0,g.errorObject.errorCode="CHAT-107",g.errorObject.severity="HIGH",e.resolve(g);break;case 500:g.isErrorPresent=!0,g.errorObject.errorCode="CHAT-105",g.errorObject.severity="HIGH",e.resolve(g);break;default:g.isErrorPresent=!0,g.errorObject.errorCode="CHAT-105",g.errorObject.severity="HIGH",e.resolve(g)}})},n=function(b,d,e,f,g){var h={isErrorPresent:!1,returnData:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}},i="<attributesInfo languageCode='";i+=d?d:"en",i+="' countryCode='",i+=e?e:"US",i+="' xmlns = 'http://bindings.egain.com/chat' >";for(var j=0;j<b.length;j++){var k=b[j];i+="<attributeInfo>",i+="<attributeName>",i+=k.attributeName,i+="</attributeName>",i+="<objectName>",i+=k.objectName,i+="</objectName>",i+="</attributeInfo>"}return i+="</attributesInfo>",a({method:"POST",url:decodeURIComponent(c.apiPath)+"/egain/chat/entrypoint/attributesInfo",headers:{"Content-Type":"text/XML","X-egain-session":g},data:i}).then(function(a){function b(a,b,c){var d=a.getElementsByTagName("ns2:"+b)[0];return d&&null!=d||(d=a.getElementsByTagName(b)[0]),d&&null!=d||c&&(d=a.getElementsByTagNameNS(c,b)[0]),d}h.isErrorPresent=!1,h.returnData={},h.errorObject={};var c={};try{for(var d=new DOMParser,e=d.parseFromString(a.data,"text/xml"),g=e.getElementsByTagNameNS("*","attributeInfo"),i=0;i<g.length;i++){var j=g[i],k=b(j,"attributeName").textContent,l=b(j,"objectName").textContent,m=b(j,"internalValue").textContent,n=b(j,"defaultValue").textContent,o=b(j,"displayValue").textContent,p=[],q=m.split(","),r=o.split(",");if(q.length==r.length)for(var s=0;s<q.length;s++)p.push({internalValue:q[s],displayValue:r[s]});c[l+"::"+k]={attributeName:k,objectName:l,attributeOptions:p,defaultValue:n}}}catch(a){}h.returnData=c,f.resolve(h)},function(a){switch(a.status){case-1:h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-107",h.errorObject.severity="HIGH",f.resolve(h);break;case 500:h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-105",h.errorObject.severity="HIGH",f.resolve(h);break;default:h.isErrorPresent=!0,h.errorObject.errorCode="CHAT-105",h.errorObject.severity="HIGH",f.resolve(h)}})},o=function(b,e,f,g,h,i,j,k,l,m,n,o){var p="";null!==m&&(p=d(m));var q={usertype:"customer",portalId:b,entryPointId:f,subject:g,description:h,name:j,emailAddress:k,phone:l,maxResults:o,$attribute:p,$pagesize:n},r={isErrorPresent:!1,returnData:{},pagingInfo:{},errorObject:{serviceType:"ChatService",serviceName:"ChatService"}};return t(b)?(r.isErrorPresent=!0,r.errorObject.errorCode="100",r.errorObject.severity="LOW",i.resolve(r)):u(b)?t(g)?(r.isErrorPresent=!0,r.errorObject.errorCode="220",r.errorObject.severity="LOW",i.resolve(r)):t(h)?(r.isErrorPresent=!0,r.errorObject.errorCode="221",r.errorObject.severity="LOW",i.resolve(r)):a({method:"GET",url:decodeURIComponent(c.ssApiPath)+"/ws/v11/ss/escalate/search",headers:{Accept:"application/json","Content-Type":"application/json","X-egain-session":e},params:q}).then(function(a){r.isErrorPresent=!1,r.returnData={},r.pagingInfo={},r.errorObject={},r.xEgainSession=a.headers("X-egain-session"),r.returnData=a.data.article,r.pagingInfo=a.data.pagingInfo,i.resolve(r)},function(a){switch(a.status){case 401:r.isErrorPresent=!0,r.errorObject.errorCode="103",r.errorObject.severity="HIGH",i.resolve(r);break;case 404:r.isErrorPresent=!0,a.data.callInfo.message.indexOf("The portalId "+a.data.callInfo.portalId+" does not exist")>-1&&(r.errorObject.errorCode="102",r.errorObject.severity="LOW"),i.resolve(r);break;case 412:r.isErrorPresent=!0,r.errorObject.errorCode="217",r.errorObject.severity="HIGH",i.resolve(r);break;case 500:default:r.isErrorPresent=!0,r.errorObject.errorCode=a.status,r.errorObject.errorMessage=a.statusText,i.resolve(r)}}):(r.isErrorPresent=!0,r.errorObject.errorCode="106",r.errorObject.severity="LOW",i.resolve(r))},p=function(b,e,g,h,i,j,k,l){var m=d(i),n={isErrorPresent:!1,xEgainSession:"",returnData:{},pagingInfo:{},errorObject:{serviceType:"SelfService",serviceName:"ArticleService"}};if(t(b))return n.isErrorPresent=!0,n.errorObject.errorCode="100",n.errorObject.severity="LOW",n.errorObject.errorMessage=f[errorMessageLanguage][100],l.resolve(n);if(!u(b))return n.isErrorPresent=!0,n.errorObject.errorCode="106",n.errorObject.severity="LOW",n.errorObject.errorMessage=f[errorMessageLanguage][106],l.resolve(n);if(!v(e))return n.isErrorPresent=!0,n.errorObject.errorCode="101",n.errorObject.severity="LOW",n.errorObject.errorMessage=f[errorMessageLanguage][101],l.resolve(n);if(!x(h))return n.isErrorPresent=!0,n.errorObject.errorCode="206",n.errorObject.severity="LOW",n.errorObject.errorMessage=f[errorMessageLanguage][206],l.resolve(n);var o={portalId:b,usertype:e,$attribute:m};return j&&(o.q=j),k&&(o.context=k),a({method:"GET",url:decodeURIComponent(c.ssApiPath)+"/ws/v11/ss/article/"+h,headers:{Accept:"application/json","Content-Type":"application/json","X-egain-session":g},params:o}).then(function(a){n.isErrorPresent=!1,n.returnData={},n.errorObject={},n.returnData=a.data.article[0],n.returnData.articleEditions=[],angular.isDefined(a.data.article[0].availableEditions)&&(n.returnData.articleEditions=a.data.article[0].availableEditions),n.xEgainSession=a.headers("X-egain-session"),l.resolve(n)},function(a){switch(a.status){case-1:n.isErrorPresent=!0,n.errorObject.errorCode="107",n.errorObject.severity="HIGH",l.resolve(n);break;case 401:if(n.isErrorPresent=!0,!a.data.deploymentInfo.spAuthenticationEnabled){n.errorObject.errorCode="103",n.errorObject.severity="HIGH",l.resolve(n);break}SelfServiceAuthenticationService.RedirectToIDPServer(a,l);case 403:n.isErrorPresent=!0,a.data.callInfo.message.indexOf("Requested article '"+a.data.callInfo.resourceId+"' is not available")>-1?(n.errorObject.errorCode="201",n.errorObject.severity="LOW"):(n.errorObject.errorCode="103",n.errorObject.severity="HIGH"),l.resolve(n);break;case 404:n.isErrorPresent=!0,a.data.callInfo.message.indexOf("Requested article '"+a.data.callInfo.resourceId+"' is not available")>-1?(n.errorObject.errorCode="201",n.errorObject.severity="LOW"):a.data.callInfo.message.indexOf("The portalId "+a.data.callInfo.portalId+" does not exist")>-1&&(n.errorObject.errorCode="102",n.errorObject.severity="LOW"),l.resolve(n);break;case 500:n.isErrorPresent=!0,n.errorObject.errorCode="105",n.errorObject.severity="HIGH",l.resolve(n);break;default:n.isErrorPresent=!0,n.errorObject.errorCode="105",n.errorObject.severity="HIGH",l.resolve(n)}})},q=function(b,d,e,f){var g={isErrorPresent:!1,xEgainSession:"",returnData:{},pagingInfo:{},errorObject:{serviceType:"SelfService",serviceName:"EscalationService"}};return t(b)?(g.isErrorPresent=!0,g.errorObject.errorCode="100",g.errorObject.severity="LOW",f.resolve(g)):u(b)?a({method:"GET",url:decodeURIComponent(c.ssApiPath)+"/ws/v11/ss/escalate/avert",headers:{Accept:"application/json","Content-Type":"application/json","X-egain-session":e},params:{portalId:b,entryPointId:d,usertype:"customer",$lang:c.locale}}).then(function(a){g.isErrorPresent=!1,g.returnData={},g.errorObject={},g.xEgainSession=a.headers("X-egain-session"),g.returnData=a.data,f.resolve(g)},function(a){switch(a.status){case 401:g.isErrorPresent=!0,g.errorObject.errorCode="103",g.errorObject.severity="HIGH",f.resolve(g);break;case 404:g.isErrorPresent=!0,a.data.callInfo.message.indexOf("The portalId "+a.data.callInfo.portalId+" does not exist")>-1&&(g.errorObject.errorCode="102",g.errorObject.severity="LOW"),f.resolve(g);break;case 412:g.isErrorPresent=!0,g.errorObject.errorCode="217",g.errorObject.severity="HIGH",f.resolve(g);break;case 500:default:g.isErrorPresent=!0,g.errorObject.errorCode=a.status,g.errorObject.errorMessage=a.statusText,f.resolve(g)}}):(g.isErrorPresent=!0,g.errorObject.errorCode="106",g.errorObject.severity="LOW",f.resolve(g))},r=function(b,d,e){var f={isErrorPresent:!1,xEgainSession:"",returnData:{},pagingInfo:{},errorObject:{serviceType:"SelfService",serviceName:"AuthenticationService"}};return t(b)?(f.isErrorPresent=!0,f.errorObject.errorCode="100",f.errorObject.severity="LOW",e.resolve(f)):u(b)?a({method:"POST",url:decodeURIComponent(c.ssApiPath)+"/ws/v15/ss/portal/"+b+"/authentication/anonymous",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":eGainJsUtilities.GetAcceptLanguageHeader(c.locale)}}).then(function(a){f.isErrorPresent=!1,f.returnData={},f.errorObject={},f.returnData=!0,f.xEgainSession=a.headers("X-egain-session"),e.resolve(f)},function(a){switch(a.status){case 401:f.isErrorPresent=!0,f.errorObject.errorCode="103",f.errorObject.severity="HIGH",e.resolve(f);break;case 404:f.isErrorPresent=!0,f.errorObject.errorCode="102",f.errorObject.severity="LOW",e.resolve(f);break;case 412:f.isErrorPresent=!0,f.errorObject.errorCode="217",f.errorObject.severity="HIGH",e.resolve(f);break;case 500:default:f.isErrorPresent=!0,f.errorObject.errorCode=a.status,f.errorObject.errorMessage=a.statusText,e.resolve(f)}}):(f.isErrorPresent=!0,f.errorObject.errorCode="106",f.errorObject.severity="LOW",e.resolve(f))},s=function(b,d,e,g,h,i,j,k,l){var m={isErrorPresent:!1,returnData:{},pagingInfo:{},errorObject:{serviceType:"GuidedHelp",serviceName:"ChatService"}};if(t(d))return m.isErrorPresent=!0,m.errorObject.errorCode="CHAT-300",m.errorObject.severity="LOW",m.errorObject.errorMessage=f["CHAT-300"],l.resolve(m);if(!u(d))return m.isErrorPresent=!0,m.errorObject.errorCode="CHAT-300",m.errorObject.severity="LOW",m.errorObject.errorMessage=f["CHAT-300"],l.resolve(m);if(!v(e))return m.isErrorPresent=!0,m.errorObject.errorCode="CHAT-301",m.errorObject.severity="LOW",m.errorObject.errorMessage=f["CHAT-301"],l.resolve(m);if(t(h))return m.isErrorPresent=!0,m.errorObject.errorCode="CHAT-302",m.errorObject.severity="LOW",m.errorObject.errorMessage=f["CHAT-302"],l.resolve(m);if(!u(h))return m.isErrorPresent=!0,m.errorObject.errorCode="CHAT-302",m.errorObject.severity="LOW",m.errorObject.errorMessage=f["CHAT-302"],l.resolve(m);var n={portalId:d,usertype:e,$lang:c.locale};k&&(n.linkToActivity="yes");var o={casebaseId:h};return i&&(o.name=i),j&&(o.comment=j),a({method:"POST",url:decodeURIComponent(b)+"/ws/v11/gh/quickpick",headers:{Accept:"application/json","Content-Type":"application/json","X-egain-session":g,"X-egain-activity-id":k},params:n,data:eGainJsUtilities.PostParams(o)}).then(function(a){m.xEgainSession=a.headers("X-egain-session"),m.isErrorPresent=!1,m.errorObject={},m.returnData=a.data.quickpick,l.resolve(m)},function(a){switch(a.status){case 401:m.isErrorPresent=!0,eGainJsUtilities.isRedirectToSSOServer(a)?(m.errorObject.errorCode="CHAT-308",m.errorObject.severity="HIGH",m.errorObject.errorMessage=f["CHAT-308"],l.resolve(m)):(m.errorObject.errorCode="CHAT-303",m.errorObject.severity="HIGH",m.errorObject.errorMessage=f["CHAT-303"],l.resolve(m));break;case 404:m.isErrorPresent=!0,a.data.callInfo.message.indexOf("The portalId "+a.data.callInfo.portalId+" does not exist")>-1?(m.errorObject.errorCode="CHAT-304",m.errorObject.severity="LOW",m.errorObject.errorMessage=f["CHAT-304"]):a.data.callInfo.message.indexOf("Casebase")>-1&&a.data.callInfo.message.indexOf("does not exist")>-1&&(m.errorObject.errorCode="CHAT-305",m.errorObject.severity="LOW",m.errorObject.errorMessage=f["CHAT-305"]),l.resolve(m);break;case 412:m.isErrorPresent=!0,a.data.callInfo.message.indexOf("The user type does not match the existing usertype")>-1?(m.errorObject.errorCode="CHAT-306",m.errorObject.severity="HIGH",m.errorObject.errorMessage=f["CHAT-306"]):a.data.callInfo.message.indexOf("Quick picks may only be created for Live releases")>-1&&(m.errorObject.errorCode="CHAT-307",m.errorObject.severity="HIGH",m.errorObject.errorMessage=f["CHAT-307"]),l.resolve(m);break;case 500:default:m.isErrorPresent=!0,m.errorObject.errorCode=a.status,m.errorObject.errorMessage=a.statusText,l.resolve(m)}})},t=function(a){return void 0===a||""===a},u=function(a){return!isNaN(a)&&!(!isNaN(a)&&a<0)},v=function(a){return"customer"===a||"agent"===a},w=function(a){if(!a)return"";if(a.constructor!=Array)a=a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");else for(var b=0;b<a.length;b++)a[b]=a[b].replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return a},x=function(a){var b=new RegExp("[0-9A-Z]{0,4}-[0-9]{4,}"),c=new RegExp("[0-9]{15}");return b.test(a)||c.test(a)};return e}]),function(a,b){a.GetCookie=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return""},a.SetCookie=function(a,b){document.cookie=a+"="+b},a.PostParams=function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},a.xmlToJson=function(a){var b={};if(1==a.nodeType){if(a.attributes.length>0){b["@attributes"]={};for(var c=0;c<a.attributes.length;c++){var d=a.attributes.item(c);b["@attributes"][d.nodeName]=d.nodeValue}}}else 3==a.nodeType&&(b=a.nodeValue);if(a.hasChildNodes())for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes.item(e),g=f.nodeName;if("undefined"==typeof b[g])b[g]=this.xmlToJson(f);else{if("undefined"==typeof b[g].push){var h=b[g];b[g]=[],b[g].push(h)}b[g].push(this.xmlToJson(f))}}return b};var c={"en-US":"en-us","fr-FR":"fr-fr","es-ES":"es-es","it-IT":"it-it","de-DE":"de-de","nl-NL":"nl-nl","pt-BR":"pt-br","pt-PT":"pt-pt","da-DA":"da-dk","ru-RU":"ru-ru","fr-CA":"fr-ca","zh-CN":"zh-cn","ja-JA":"ja-jp","ko-KO":"ko-kr","sv-SE":"sv-se"};a.GetAcceptLanguageHeader=function(a){var b="en-us";return"undefined"!=typeof c&&null!=c&&"undefined"!=typeof c[a]&&null!=c[a]&&(b=c[a]),b},a.isRedirectToSSOServer=function(a){return!!(a.data.providers&&a.data.providers.provider.length>0||(a.data.deploymentInfo.idpURL||a.data.deploymentInfo.idpLoginURL||a.data.deploymentInfo.idpLogoutURL)&&!angular.equals("true",window.sessionStorage.getItem("ngStorage-isLocalLogin")))},a.getLogoutDetailsForSSOIDPServer=function(a){var b={action:null,samlRequest:null,relayState:null,success:!1};return a&&a.data&&a.data.idpLogoutUrl&&a.data.samlRequest&&(b.action=a.data.idpLogoutUrl,b.samlRequest=a.data.samlRequest,b.success=!0),b},a.getLogoutDetailsForSSOIDPServerForKnowledgePortal=function(a){var b,c={action:null,samlRequest:null,relayState:null,success:!1};if(a&&a.data&&(b=a.data.deploymentInfo)){var d=b.idpURL?b.idpURL:b.idpLogoutURL,e=b.samlToken?b.samlToken:b.samlRequest;d&&e&&(c.action=d,c.samlRequest=e,c.success=!0)}return c}}(window.eGainJsUtilities=window.eGainJsUtilities||{});